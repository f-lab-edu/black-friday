# Feature/kafka Branch 정보

# 본론
블랙 프라이데이에 실시간 스트리밍을 지원하는 카프카를 적용하고자 합니다.
이번 프로젝트를 통해 카프카의 원리와 기능의 장단점을 파악해보고자 합니다.

😒**But**

카프카는 결국 자원을 소모하여 사용하는 시스템이기에, 서버를 구축하는 과정에 비용이 발생할 수 밖에 없습니다.
그렇기 때문에 막무가내로 적용하기 보단 적용하고자 하는 이유가 필요합니다.


## 카프카를 왜 적용하려는가?

1. 카프카에 대한 개념과 직접 실습을 통해 활용법을 익히고자 함
2. 블랙 프라이데이는 이커머스로 특성상 이용자가 많아지는 시점에 카프카 사용은 불가피하다고 판단
    - 블랙 프라이데이는 할인 이벤트가 주이기 때문에 대용량 트래픽이 발생 할 수 밖에 없다고 보기 때문입니다.


## 카프카를 어디에 적용하려고 하는가?

* 블랙 프라이데이는 말 그대로 파격가 할인을 제공하는 이벤트가 많습니다.
  1. 특별 이벤트에 해당하는 상품들에 대한 접속을 카프카를 이용하여 처리할 수 있습니다.
  2. 이커머스이기에 주문이 발생하는 부분에 대하여 카프카를 적용할 수 있습니다.
  3. 특별 할인가를 제공하는 쿠폰 선착순 지급 API에 대한 카프카를 적용할 수 있습니다.
  

### 3번 경우에 대한 카프카를 적용하려는 이유

* 대규모 트래픽 발생이 예상되는 선착순 개념과, 한정 쿠폰에 대한 수요이기 때문에 재고에 대한 데이터 적합성(동시성)검사가 필수적으로 필요한 상황이라고 판단이 됩니다.


## 쿠폰 발급 구성

### 쿠폰 발급 시퀀스 다이어그램

> 쿠폰 발급

![image](https://github.com/f-lab-edu/black-friday/assets/67618667/39751bb4-195e-4c67-aa30-62dc480015f2)

1. 사용자가 쿠폰 발급을 신청하게 됩니다.
2. 쿠폰 발급이 발생하게 되면, Producer를 통해 Broker 영역으로 데이터가 넘어가게 됩니다.
3. 쿠폰 발급 정보를 데이터베이스에 저장하고, 생성된 쿠폰은 리턴하게 됩니다.
4. 리턴된 쿠폰은 바로 사용자에게 전달 됩니다.


### 카프카를 이용한 쿠폰 발급 기대효과

1. 실시간 대용량 트래픽 처리
    1. 특정 이벤트로 인한 쿠폰 발급이라는 특수성이 있는 환경에서 대용량 트래픽 부하에 대한 성능 저하를 방지할 수 있습니다.
2. 독립적인 서버를 통한 데이터 관리
    1. 서버 이슈로 인한 데이터 이슈에 대하여 캐싱을 통해 데이터를 관리할 수 있습니다.
        1. 예시로 쿠폰 발급 과정에서 발생하는 서버 이슈에 대하여 데이터 이슈를 임시 보존을 통해 대처할 수 있는 기대 효과를 얻을 수 있습니다.
3. 동시성 제어
    1. 카프카 시스템을 통해 비관적 락 또는 낙관적 락를 사용하지 않고 처리할 수 있습니다.
        1. 특히 비관적 락과 같이 데이터베이스에 악영향을 줄 수 있는 상황을 만들지 않을 수 있습니다.
      

### 카프카를 사용한 자세한 내용 보기 
1. [카프카란 무엇인가](https://github.com/f-lab-edu/black-friday/wiki/Apache-Kafka-%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80%3F)
2. [카프카 적용하기1](https://github.com/f-lab-edu/black-friday/wiki/SpringBoot-Apache-Kafka-Part(1))
3. [카프카 적용하기2](https://github.com/f-lab-edu/black-friday/wiki/SpringBoot-Apache-Kafka-Part(2))

